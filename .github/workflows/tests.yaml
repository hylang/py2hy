name: Run tests

on: [pull_request, push]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v6
    - uses: actions/setup-python@v6
      with: {python-version: 3.14}
    - run: pip install git+https://github.com/hylang/hy.git@8a32e579f254d9690789e4bc3f3e86a6ff7c4eb6
    - run: pip install hyrule --no-deps
    - run: pip install .
    - run: pip install pytest
    - uses: actions/cache@v4
      with:
        key: cache-dir
        path: .pytest_cache/d
    - run: pytest
